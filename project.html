<!DOCTYPE html><html><head><meta charset='utf-8'><meta http-equiv='Access-Control-Allow-Origin' content='*'><meta http-equiv='Access-Control-Allow-Credentials' content='true'><script src='https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js'></script><script src='https://fustyles.github.io/webduino/SpBlocklyJS/GameElements_20190131/gameelements.js'></script><link rel='stylesheet' href='https://fustyles.github.io/webduino/SpBlocklyJS/css/icon_custom.css' /><script src='https://fustyles.github.io/webduino/SpBlocklyJS/SpreadsheetSQL_20210403/spreadsheetsql.js'></script><script src='https://fustyles.github.io/webduino/SpBlocklyJS/SpreadsheetSQL_20210403/loader.js'></script><script src='https://fustyles.github.io/webduino/SpBlocklyJS/chart_20220723/Chart.min.js'></script><script src='https://fustyles.github.io/webduino/SpBlocklyJS/chart_20220723/barchart.js'></script></head><body>
<script>
const delay = (seconds) => {
    return new Promise((resolve) => {
        setTimeout(resolve, seconds * 1000);
    });
};
const main = async () => {
    var i;

    function spreadsheetsql_QueryResponse_1(res) {
        spreadsheetsql_QueryResponse(res, "1");
    }
    window.spreadsheetsql_QueryResponse_1 = spreadsheetsql_QueryResponse_1;

    async function spreadsheetsql_getDataFinish_1(head_response, response) {
        text_create('1', 60, 30, 700, 100, '#ffffff', '#000000', 14, 1, (spreadsheetsql_getCell(1, 1, "1")), 999, true);

    };
    window.spreadsheetsql_getDataFinish_1 = spreadsheetsql_getDataFinish_1;

    // 描述此函式...
    function my_501() {
        spreadsheetsql_settings('1hW4z_cxEFCvq-WBE1-UnInM2J3mHKWK9BNrdD472RFE/edit?gid=0#gid=0', 'nelson', "1");
        spreadsheetsql_executeSql('select D limit 2 offset 0', "1");
    }

    function spreadsheetsql_QueryResponse_2(res) {
        spreadsheetsql_QueryResponse(res, "2");
    }
    window.spreadsheetsql_QueryResponse_2 = spreadsheetsql_QueryResponse_2;

    async function spreadsheetsql_getDataFinish_2(head_response, response) {
        text_create('2', 60, 30, 700, 135, '#ffffff', '#000000', 14, 1, (spreadsheetsql_getCell(1, 1, "2")), 999, true);

    };
    window.spreadsheetsql_getDataFinish_2 = spreadsheetsql_getDataFinish_2;

    // 描述此函式...
    function my_501_E4_BA_BA_E6_95_B8() {
        spreadsheetsql_settings('1hW4z_cxEFCvq-WBE1-UnInM2J3mHKWK9BNrdD472RFE/edit?gid=0#gid=0', 'nelson', "2");
        spreadsheetsql_executeSql('select E limit 2 offset 0', "2");
    }

    function spreadsheetsql_QueryResponse_3(res) {
        spreadsheetsql_QueryResponse(res, "3");
    }
    window.spreadsheetsql_QueryResponse_3 = spreadsheetsql_QueryResponse_3;

    async function spreadsheetsql_getDataFinish_3(head_response, response) {
        text_create('3', 60, 30, 770, 100, '#ffffff', '#000000', 14, 1, (spreadsheetsql_getCell(1, 2, "3")), 999, true);

    };
    window.spreadsheetsql_getDataFinish_3 = spreadsheetsql_getDataFinish_3;

    // 描述此函式...
    function my_502() {
        spreadsheetsql_settings('1hW4z_cxEFCvq-WBE1-UnInM2J3mHKWK9BNrdD472RFE/edit?gid=0#gid=0', 'nelson', "3");
        spreadsheetsql_executeSql('select D limit 3 offset 0', "3");
    }

    function spreadsheetsql_QueryResponse_4(res) {
        spreadsheetsql_QueryResponse(res, "4");
    }
    window.spreadsheetsql_QueryResponse_4 = spreadsheetsql_QueryResponse_4;

    async function spreadsheetsql_getDataFinish_4(head_response, response) {
        text_create('4', 60, 30, 770, 135, '#ffffff', '#000000', 14, 1, (spreadsheetsql_getCell(1, 2, "4")), 999, true);

    };
    window.spreadsheetsql_getDataFinish_4 = spreadsheetsql_getDataFinish_4;

    // 描述此函式...
    function my_502_E4_BA_BA_E6_95_B8() {
        spreadsheetsql_settings('1hW4z_cxEFCvq-WBE1-UnInM2J3mHKWK9BNrdD472RFE/edit?gid=0#gid=0', 'nelson', "4");
        spreadsheetsql_executeSql('select E limit 3 offset 0', "4");
    }

    function spreadsheetsql_QueryResponse_5(res) {
        spreadsheetsql_QueryResponse(res, "5");
    }
    window.spreadsheetsql_QueryResponse_5 = spreadsheetsql_QueryResponse_5;

    async function spreadsheetsql_getDataFinish_5(head_response, response) {
        text_create('5', 60, 30, 700, 200, '#ffffff', '#000000', 14, 1, (spreadsheetsql_getCell(1, 1, "5")), 999, true);

    };
    window.spreadsheetsql_getDataFinish_5 = spreadsheetsql_getDataFinish_5;

    // 描述此函式...
    function my_501_E6_B8_9B_E7_A2_B3_E9_87_8F() {
        spreadsheetsql_settings('1hW4z_cxEFCvq-WBE1-UnInM2J3mHKWK9BNrdD472RFE/edit?gid=0#gid=0', 'nelson', "5");
        spreadsheetsql_executeSql('select F limit 2 offset 0', "5");
    }

    function spreadsheetsql_QueryResponse_6(res) {
        spreadsheetsql_QueryResponse(res, "6");
    }
    window.spreadsheetsql_QueryResponse_6 = spreadsheetsql_QueryResponse_6;

    async function spreadsheetsql_getDataFinish_6(head_response, response) {
        text_create('6', 60, 30, 770, 200, '#ffffff', '#000000', 14, 1, (spreadsheetsql_getCell(1, 2, "6")), 999, true);

    };
    window.spreadsheetsql_getDataFinish_6 = spreadsheetsql_getDataFinish_6;

    // 描述此函式...
    function my_502__E6_B8_9B_E7_A2_B3_E9_87_8F() {
        spreadsheetsql_settings('1hW4z_cxEFCvq-WBE1-UnInM2J3mHKWK9BNrdD472RFE/edit?gid=0#gid=0', 'nelson', "6");
        spreadsheetsql_executeSql('select F limit 3 offset 0', "6");
    }


    var config = {
        id: '',
        type: "bar",
        data: {
            labels: [],
            datasets: [{
                label: '501',
                data: [],
                borderColor: '#ff0000',
                backgroundColor: '#ff0000'
            }, {
                label: '502',
                data: [],
                borderColor: '#0000ff',
                backgroundColor: '#0000ff'
            }]
        },
        options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
                legend: {
                    position: "top",
                },
                title: {
                    display: true,
                    text: '501 and 502 步行減碳統計圖'
                }
            },
            scales: {
                yAxes: {
                    title: {
                        display: true,
                        text: '人數',
                    },
                    ticks: {
                        precision: 0
                    }
                },
                xAxes: {
                    title: {
                        display: true,
                        text: '班級',
                    }
                }
            }
        },
        width: 600,
        height: 400,
        left: 0,
        top: 0,
        count: 100
    };
    barchart(config);
    my_501();
    my_502();
    my_501_E4_BA_BA_E6_95_B8();
    my_502_E4_BA_BA_E6_95_B8();
    my_501_E6_B8_9B_E7_A2_B3_E9_87_8F();
    my_502__E6_B8_9B_E7_A2_B3_E9_87_8F();
    while (true) {
        await delay(1);
        barchart({
            id: '',
            clear: ""
        });
        my_501();
        my_502();
        barchart({
            id: '',
            data: [(getDatetime(i, "datetime")), text_get('2', "value"), text_get('4', "value")]
        });
    }
};
main();
</script>
</body></html>