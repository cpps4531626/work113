<!DOCTYPE html><html><head><meta charset='utf-8'><meta http-equiv='Access-Control-Allow-Headers' content='Origin, X-Requested-With, Content-Type, Accept'><meta http-equiv='Access-Control-Allow-Methods' content='GET,POST,PUT,DELETE,OPTIONS'><meta http-equiv='Access-Control-Allow-Origin' content='*'><meta http-equiv='Access-Control-Allow-Credentials' content='true'><script src='https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js'></script><script src='https://fustyles.github.io/webduino/SpBlocklyJS/GameElements_20190131/marked.min.js'></script><script src='https://fustyles.github.io/webduino/SpBlocklyJS/GameElements_20190131/gameelements.js'></script><link rel='stylesheet' href='https://fustyles.github.io/webduino/SpBlocklyJS/css/icon_custom.css' /><script src='https://fustyles.github.io/webduino/SpBlocklyJS/MQTT_20220324/mqtt.min.js'></script><script src='https://fustyles.github.io/webduino/SpBlocklyJS/SpreadsheetSQL_20210403/spreadsheetsql.js'></script><script src='https://fustyles.github.io/webduino/SpBlocklyJS/SpreadsheetSQL_20210403/loader.js'></script></head><body>
<script>
const delay = (seconds) => {
    return new Promise((resolve) => {
        setTimeout(resolve, seconds * 1000);
    });
};
const main = async () => {
    function spreadsheetsql_QueryResponse_8l(res) {
        spreadsheetsql_QueryResponse(res, "8l");
    }
    window.spreadsheetsql_QueryResponse_8l = spreadsheetsql_QueryResponse_8l;

    async function spreadsheetsql_getDataFinish_8l(head_response, response) {
        div_create('8l', 300, 30, 250, 100, "solid", 2, '#cccccc', '#99ff99', '#000000', 20, 1, (spreadsheetsql_getCell(1, 1, "8l")), 999, true);

    };
    window.spreadsheetsql_getDataFinish_8l = spreadsheetsql_getDataFinish_8l;

    function spreadsheetsql_QueryResponse_9l(res) {
        spreadsheetsql_QueryResponse(res, "9l");
    }
    window.spreadsheetsql_QueryResponse_9l = spreadsheetsql_QueryResponse_9l;

    async function spreadsheetsql_getDataFinish_9l(head_response, response) {
        div_create('9l', 300, 30, 250, 150, "solid", 2, '#cccccc', '#99ff99', '#000000', 20, 1, (spreadsheetsql_getCell(1, 2, "9l")), 999, true);

    };
    window.spreadsheetsql_getDataFinish_9l = spreadsheetsql_getDataFinish_9l;

    function spreadsheetsql_QueryResponse_11l(res) {
        spreadsheetsql_QueryResponse(res, "11l");
    }
    window.spreadsheetsql_QueryResponse_11l = spreadsheetsql_QueryResponse_11l;

    async function spreadsheetsql_getDataFinish_11l(head_response, response) {
        div_create('11l', 300, 30, 250, 250, "solid", 2, '#cccccc', '#99ff99', '#000000', 20, 1, (spreadsheetsql_getCell(1, 4, "11l")), 999, true);

    };
    window.spreadsheetsql_getDataFinish_11l = spreadsheetsql_getDataFinish_11l;

    function spreadsheetsql_QueryResponse_10l(res) {
        spreadsheetsql_QueryResponse(res, "10l");
    }
    window.spreadsheetsql_QueryResponse_10l = spreadsheetsql_QueryResponse_10l;

    async function spreadsheetsql_getDataFinish_10l(head_response, response) {
        div_create('10l', 300, 30, 250, 200, "solid", 2, '#cccccc', '#99ff99', '#000000', 20, 1, (spreadsheetsql_getCell(1, 3, "10l")), 999, true);
        div_create('11l', 300, 30, 250, 250, "solid", 2, '#cccccc', '#99ff99', '#000000', 20, 1, '', 999, true);
        spreadsheetsql_settings('1hW4z_cxEFCvq-WBE1-UnInM2J3mHKWK9BNrdD472RFE', 'rideshare_all', "11l");
        spreadsheetsql_executeSql('select F limit 4 offset 0', "11l");

    };
    window.spreadsheetsql_getDataFinish_10l = spreadsheetsql_getDataFinish_10l;

    function spreadsheetsql_QueryResponse_12l(res) {
        spreadsheetsql_QueryResponse(res, "12l");
    }
    window.spreadsheetsql_QueryResponse_12l = spreadsheetsql_QueryResponse_12l;

    async function spreadsheetsql_getDataFinish_12l(head_response, response) {
        div_create('12l', 300, 30, 250, 300, "solid", 2, '#cccccc', '#99ff99', '#000000', 20, 1, (spreadsheetsql_getCell(1, 5, "12l")), 999, true);

    };
    window.spreadsheetsql_getDataFinish_12l = spreadsheetsql_getDataFinish_12l;

    function spreadsheetsql_QueryResponse_13l(res) {
        spreadsheetsql_QueryResponse(res, "13l");
    }
    window.spreadsheetsql_QueryResponse_13l = spreadsheetsql_QueryResponse_13l;

    async function spreadsheetsql_getDataFinish_13l(head_response, response) {
        div_create('13l', 300, 30, 250, 350, "solid", 2, '#cccccc', '#99ff99', '#000000', 20, 1, (spreadsheetsql_getCell(1, 6, "13l")), 999, true);

    };
    window.spreadsheetsql_getDataFinish_13l = spreadsheetsql_getDataFinish_13l;

    // 描述此函式...
    function _E4_BD_8F_E6_88_B6() {
        div_create('8l', 300, 30, 250, 100, "solid", 2, '#cccccc', '#99ff99', '#000000', 20, 1, '', 999, true);
        spreadsheetsql_settings('1hW4z_cxEFCvq-WBE1-UnInM2J3mHKWK9BNrdD472RFE', 'rideshare_all', "8l");
        spreadsheetsql_executeSql('select F limit 1 offset 0', "8l");
        div_create('9l', 300, 30, 250, 150, "solid", 2, '#cccccc', '#99ff99', '#000000', 20, 1, '', 999, true);
        spreadsheetsql_settings('1hW4z_cxEFCvq-WBE1-UnInM2J3mHKWK9BNrdD472RFE', 'rideshare_all', "9l");
        spreadsheetsql_executeSql('select F limit 2 offset 0', "9l");
        div_create('10l', 300, 30, 250, 200, "solid", 2, '#cccccc', '#99ff99', '#000000', 20, 1, '', 999, true);
        spreadsheetsql_settings('1hW4z_cxEFCvq-WBE1-UnInM2J3mHKWK9BNrdD472RFE', 'rideshare_all', "10l");
        spreadsheetsql_executeSql('select F limit 3 offset 0', "10l");
        div_create('12l', 300, 30, 250, 300, "solid", 2, '#cccccc', '#99ff99', '#000000', 20, 1, '', 999, true);
        spreadsheetsql_settings('1hW4z_cxEFCvq-WBE1-UnInM2J3mHKWK9BNrdD472RFE', 'rideshare_all', "12l");
        spreadsheetsql_executeSql('select F limit 5 offset 0', "12l");
        div_create('13l', 300, 30, 250, 350, "solid", 2, '#cccccc', '#99ff99', '#000000', 20, 1, '', 999, true);
        spreadsheetsql_settings('1hW4z_cxEFCvq-WBE1-UnInM2J3mHKWK9BNrdD472RFE', 'rideshare_all', "13l");
        spreadsheetsql_executeSql('select F limit 6 offset 0', "13l");
    }

    // 描述此函式...
    function button() {
        button_create('1', 60, 30, 600, 100, 1, null, '提醒', 15, 999, true);
        button_create('2', 60, 30, 600, 150, 1, null, '提醒', 15, 999, true);
        button_create('3', 60, 30, 600, 200, 1, null, '提醒', 15, 999, true);
        button_create('4', 60, 30, 600, 250, 1, null, '提醒', 15, 999, true);
        button_create('5', 60, 30, 600, 300, 1, null, '提醒', 15, 999, true);
        button_create('6', 60, 30, 600, 350, 1, null, '提醒', 15, 999, true);
        async function gamebutton_1_onclick(event) {
            mqtt_client.publish('qpps/data1204', String('warning1'));
        };
        document.getElementById("gamebutton_1").addEventListener("click", gamebutton_1_onclick, true);
        async function gamebutton_2_onclick(event) {
            mqtt_client.publish('qpps/data1204', String('warning2'));
        };
        document.getElementById("gamebutton_2").addEventListener("click", gamebutton_2_onclick, true);
        async function gamebutton_3_onclick(event) {
            mqtt_client.publish('qpps/data1204', String('warning3'));
        };
        document.getElementById("gamebutton_3").addEventListener("click", gamebutton_3_onclick, true);
        async function gamebutton_4_onclick(event) {
            mqtt_client.publish('qpps/data1204', String('warning4'));
        };
        document.getElementById("gamebutton_4").addEventListener("click", gamebutton_4_onclick, true);
        async function gamebutton_5_onclick(event) {
            mqtt_client.publish('qpps/data1204', String('warning5'));
        };
        document.getElementById("gamebutton_5").addEventListener("click", gamebutton_5_onclick, true);
        async function gamebutton_6_onclick(event) {
            mqtt_client.publish('qpps/data1204', String('warning6'));
        };
        document.getElementById("gamebutton_6").addEventListener("click", gamebutton_6_onclick, true);
    }

    function spreadsheetsql_QueryResponse_8p(res) {
        spreadsheetsql_QueryResponse(res, "8p");
    }
    window.spreadsheetsql_QueryResponse_8p = spreadsheetsql_QueryResponse_8p;

    async function spreadsheetsql_getDataFinish_8p(head_response, response) {
        div_create('8p', 60, 30, 150, 100, "solid", 2, '#330033', '#ffff99', '#000000', 20, 1, (spreadsheetsql_getCell(1, 1, "8p")), 999, true);

    };
    window.spreadsheetsql_getDataFinish_8p = spreadsheetsql_getDataFinish_8p;

    function spreadsheetsql_QueryResponse_9p(res) {
        spreadsheetsql_QueryResponse(res, "9p");
    }
    window.spreadsheetsql_QueryResponse_9p = spreadsheetsql_QueryResponse_9p;

    async function spreadsheetsql_getDataFinish_9p(head_response, response) {
        div_create('9p', 60, 30, 150, 150, "solid", 2, '#330033', '#ffff99', '#000000', 20, 1, (spreadsheetsql_getCell(1, 2, "9p")), 999, true);

    };
    window.spreadsheetsql_getDataFinish_9p = spreadsheetsql_getDataFinish_9p;

    function spreadsheetsql_QueryResponse_10p(res) {
        spreadsheetsql_QueryResponse(res, "10p");
    }
    window.spreadsheetsql_QueryResponse_10p = spreadsheetsql_QueryResponse_10p;

    async function spreadsheetsql_getDataFinish_10p(head_response, response) {
        div_create('10p', 60, 30, 150, 200, "solid", 2, '#330033', '#ffff99', '#000000', 20, 1, (spreadsheetsql_getCell(1, 3, "10p")), 999, true);

    };
    window.spreadsheetsql_getDataFinish_10p = spreadsheetsql_getDataFinish_10p;

    function spreadsheetsql_QueryResponse_11p(res) {
        spreadsheetsql_QueryResponse(res, "11p");
    }
    window.spreadsheetsql_QueryResponse_11p = spreadsheetsql_QueryResponse_11p;

    async function spreadsheetsql_getDataFinish_11p(head_response, response) {
        div_create('11p', 60, 30, 150, 250, "solid", 2, '#330033', '#ffff99', '#000000', 20, 1, (spreadsheetsql_getCell(1, 4, "11p")), 999, true);

    };
    window.spreadsheetsql_getDataFinish_11p = spreadsheetsql_getDataFinish_11p;

    function spreadsheetsql_QueryResponse_12p(res) {
        spreadsheetsql_QueryResponse(res, "12p");
    }
    window.spreadsheetsql_QueryResponse_12p = spreadsheetsql_QueryResponse_12p;

    async function spreadsheetsql_getDataFinish_12p(head_response, response) {
        div_create('12p', 60, 30, 150, 300, "solid", 2, '#330033', '#ffff99', '#000000', 20, 1, (spreadsheetsql_getCell(1, 5, "12p")), 999, true);

    };
    window.spreadsheetsql_getDataFinish_12p = spreadsheetsql_getDataFinish_12p;

    function spreadsheetsql_QueryResponse_13p(res) {
        spreadsheetsql_QueryResponse(res, "13p");
    }
    window.spreadsheetsql_QueryResponse_13p = spreadsheetsql_QueryResponse_13p;

    async function spreadsheetsql_getDataFinish_13p(head_response, response) {
        div_create('13p', 60, 30, 150, 350, "solid", 2, '#330033', '#ffff99', '#000000', 20, 1, (spreadsheetsql_getCell(1, 6, "13p")), 999, true);

    };
    window.spreadsheetsql_getDataFinish_13p = spreadsheetsql_getDataFinish_13p;

    // 描述此函式...
    function _E4_BA_BA_E6_95_B8() {
        div_create('8p', 60, 30, 150, 100, "solid", 2, '#330033', '#ffff99', '#000000', 20, 1, '', 999, true);
        spreadsheetsql_settings('1hW4z_cxEFCvq-WBE1-UnInM2J3mHKWK9BNrdD472RFE', 'rideshare_all', "8p");
        spreadsheetsql_executeSql('select E limit 1 offset 0', "8p");
        div_create('9p', 60, 30, 150, 150, "solid", 2, '#330033', '#ffff99', '#000000', 20, 1, '', 999, true);
        spreadsheetsql_settings('1hW4z_cxEFCvq-WBE1-UnInM2J3mHKWK9BNrdD472RFE', 'rideshare_all', "9p");
        spreadsheetsql_executeSql('select E limit 2 offset 0', "9p");
        div_create('10p', 60, 30, 150, 200, "solid", 2, '#330033', '#ffff99', '#000000', 20, 1, '', 999, true);
        spreadsheetsql_settings('1hW4z_cxEFCvq-WBE1-UnInM2J3mHKWK9BNrdD472RFE', 'rideshare_all', "10p");
        spreadsheetsql_executeSql('select E limit 3 offset 0', "10p");
        div_create('11p', 60, 30, 150, 250, "solid", 2, '#330033', '#ffff99', '#000000', 20, 1, '', 999, true);
        spreadsheetsql_settings('1hW4z_cxEFCvq-WBE1-UnInM2J3mHKWK9BNrdD472RFE', 'rideshare_all', "11p");
        spreadsheetsql_executeSql('select E limit 4 offset 0', "11p");
        div_create('12p', 60, 30, 150, 300, "solid", 2, '#330033', '#ffff99', '#000000', 20, 1, '', 999, true);
        spreadsheetsql_settings('1hW4z_cxEFCvq-WBE1-UnInM2J3mHKWK9BNrdD472RFE', 'rideshare_all', "12p");
        spreadsheetsql_executeSql('select E limit 5 offset 0', "12p");
        div_create('13p', 60, 30, 150, 350, "solid", 2, '#330033', '#ffff99', '#000000', 20, 1, '', 999, true);
        spreadsheetsql_settings('1hW4z_cxEFCvq-WBE1-UnInM2J3mHKWK9BNrdD472RFE', 'rideshare_all', "13p");
        spreadsheetsql_executeSql('select E limit 6 offset 0', "13p");
    }

    // 描述此函式...
    function time() {
        div_create('1', 60, 30, 50, 100, "solid", 2, '#000000', '#33ffff', '#000000', 20, 1, '8:00', 999, true);
        div_create('2', 60, 30, 50, 150, "solid", 2, '#000000', '#33ffff', '#000000', 20, 1, '9:00', 999, true);
        div_create('3', 60, 30, 50, 200, "solid", 2, '#000000', '#33ffff', '#000000', 20, 1, '10:00', 999, true);
        div_create('4', 60, 30, 50, 250, "solid", 2, '#000000', '#33ffff', '#000000', 20, 1, '11:00', 999, true);
        div_create('5', 60, 30, 50, 300, "solid", 2, '#000000', '#66ffff', '#000000', 20, 1, '12:00', 999, true);
        div_create('6', 60, 30, 50, 350, "solid", 2, '#000000', '#66ffff', '#000000', 20, 1, '13:00', 999, true);
    }

    // 描述此函式...
    function _E6_A8_99_E7_B1_A4() {
        span_create('1', 180, 0, 50, '管理系統', 999);
        span_create('2', 50, 70, 20, '時間', 999);
        span_create('3', 250, 70, 20, '住戶', 999);
        span_create('5', 150, 70, 20, '人數', 999);
    }


    const clientId = "mqtt_" + Math.random().toString(16).substr(2, 8);
    const options = {
        username: '',
        password: '',
        keepalive: 60,
        clientId: clientId,
        protocolId: "MQTT",
        protocolVersion: 4,
        clean: true,
        reconnectPeriod: 1000,
        connectTimeout: 30 * 1000
    }

    var mqtt_client = mqtt.connect('wss://broker.mqttgo.io:8084/mqtt', options);
    mqtt_client.on("connect", () => {
        console.log("connected");
        mqtt_client.subscribe('qpps/data1204');
        mqtt_client.on("message", async function(topic, payload) {
            if (topic == 'qpps/data1204') {}
        })
    })

    _E4_BA_BA_E6_95_B8();
    _E4_BD_8F_E6_88_B6();
    _E6_A8_99_E7_B1_A4();
    time();
    button();
};
main();
</script>
</body></html>