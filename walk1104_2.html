<!DOCTYPE html><html><head><meta charset='utf-8'><meta http-equiv='Access-Control-Allow-Origin' content='*'><meta http-equiv='Access-Control-Allow-Credentials' content='true'><script src='https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js'></script><script src='https://fustyles.github.io/webduino/SpBlocklyJS/GameElements_20190131/gameelements.js'></script><link rel='stylesheet' href='https://fustyles.github.io/webduino/SpBlocklyJS/css/icon_custom.css' /><script src='https://fustyles.github.io/webduino/SpBlocklyJS/SpreadsheetSQL_20210403/spreadsheetsql.js'></script><script src='https://fustyles.github.io/webduino/SpBlocklyJS/SpreadsheetSQL_20210403/loader.js'></script><script src='https://fustyles.github.io/webduino/SpBlocklyJS/chart_20220723/Chart.min.js'></script><script src='https://fustyles.github.io/webduino/SpBlocklyJS/chart_20220723/barchart.js'></script></head><body>
<script>
const delay = (seconds) => {
    return new Promise((resolve) => {
        setTimeout(resolve, seconds * 1000);
    });
};
const main = async () => {
    function spreadsheetsql_QueryResponse_1(res) {
        spreadsheetsql_QueryResponse(res, "1");
    }
    window.spreadsheetsql_QueryResponse_1 = spreadsheetsql_QueryResponse_1;

    async function spreadsheetsql_getDataFinish_1(head_response, response) {
        text_create('1', 60, 30, 0, 100, '#ffffff', '#000000', 14, 1, (spreadsheetsql_getCell(1, 1, "1")), 999, true);

    };
    window.spreadsheetsql_getDataFinish_1 = spreadsheetsql_getDataFinish_1;

    function spreadsheetsql_QueryResponse_2(res) {
        spreadsheetsql_QueryResponse(res, "2");
    }
    window.spreadsheetsql_QueryResponse_2 = spreadsheetsql_QueryResponse_2;

    async function spreadsheetsql_getDataFinish_2(head_response, response) {
        text_create('2', 60, 30, 0, 200, '#ffffff', '#000000', 14, 1, (spreadsheetsql_getCell(1, 2, "2")), 999, true);

    };
    window.spreadsheetsql_getDataFinish_2 = spreadsheetsql_getDataFinish_2;

    function spreadsheetsql_QueryResponse_3(res) {
        spreadsheetsql_QueryResponse(res, "3");
    }
    window.spreadsheetsql_QueryResponse_3 = spreadsheetsql_QueryResponse_3;

    async function spreadsheetsql_getDataFinish_3(head_response, response) {
        text_create('3', 60, 30, 65, 100, '#ffffff', '#000000', 14, 1, (spreadsheetsql_getCell(1, 1, "3")), 999, true);
        barchart({
            id: '',
            data: ['', text_get('3', "value"), null]
        });

    };
    window.spreadsheetsql_getDataFinish_3 = spreadsheetsql_getDataFinish_3;

    function spreadsheetsql_QueryResponse_4(res) {
        spreadsheetsql_QueryResponse(res, "4");
    }
    window.spreadsheetsql_QueryResponse_4 = spreadsheetsql_QueryResponse_4;

    async function spreadsheetsql_getDataFinish_4(head_response, response) {
        text_create('4', 60, 30, 65, 200, '#ffffff', '#000000', 14, 1, (spreadsheetsql_getCell(1, 2, "4")), 999, true);
        barchart({
            id: '',
            data: ['', null, text_get('4', "value")]
        });

    };
    window.spreadsheetsql_getDataFinish_4 = spreadsheetsql_getDataFinish_4;


    var config = {
        id: '',
        type: "bar",
        data: {
            labels: [],
            datasets: [{
                label: '601',
                data: [],
                borderColor: '#ff0000',
                backgroundColor: '#ff0000'
            }, {
                label: '602',
                data: [],
                borderColor: '#0000ff',
                backgroundColor: '#0000ff'
            }]
        },
        options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
                legend: {
                    position: "top",
                },
                title: {
                    display: true,
                    text: '步行減碳'
                }
            },
            scales: {
                yAxes: {
                    title: {
                        display: true,
                        text: '人數',
                    },
                    ticks: {
                        precision: 0
                    }
                },
                xAxes: {
                    title: {
                        display: true,
                        text: '班級',
                    }
                }
            }
        },
        width: 600,
        height: 400,
        left: 0,
        top: 0,
        count: 2
    };
    barchart(config);
    spreadsheetsql_settings('1hW4z_cxEFCvq-WBE1-UnInM2J3mHKWK9BNrdD472RFE', 'nelson', "1");
    spreadsheetsql_executeSql('select D limit 1 offset 0', "1");
    spreadsheetsql_settings('1hW4z_cxEFCvq-WBE1-UnInM2J3mHKWK9BNrdD472RFE', 'nelson', "2");
    spreadsheetsql_executeSql('select D limit 2 offset 0', "2");
    while (true) {
        await delay(5);
        spreadsheetsql_settings('1hW4z_cxEFCvq-WBE1-UnInM2J3mHKWK9BNrdD472RFE', 'nelson', "3");
        spreadsheetsql_executeSql('select E limit 1 offset 0', "3");
        spreadsheetsql_settings('1hW4z_cxEFCvq-WBE1-UnInM2J3mHKWK9BNrdD472RFE', 'nelson', "4");
        spreadsheetsql_executeSql('select E limit 2 offset 0', "4");
    }
};
main();
</script>
</body></html>